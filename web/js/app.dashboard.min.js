function updateLastEvent(){$.get("track/stats",function(a){$(".eventbutton-milk").find(".badge").html(a.leche.time),$(".eventbutton-pump").find(".badge").html(a.sacaleche.time),$(".eventbutton-diaper").find(".badge").html(a.panyal.time),$(".eventbutton-food").find(".badge").html(a.comida.time),"start"==a.dormir.type?$(".sleep-items").hasClass("hide")&&($(".sleep-items").removeClass("hide"),$("body, .face.front").animate({backgroundColor:"#D8D8D8"})):$(".sleep-items").hasClass("hide")||($(".sleep-items").addClass("hide"),$("body, .face.front").animate({backgroundColor:"#FFF"}))})}function showNotification(a,b){b=b||!1;var c=formatEvent(a),d=b?"#error-notification":"#success-notification";b||(a.reverted?($(d+" .lead strong").html("Corregido:"),$(d+" .undo").hide(),$(d).removeClass("alert-info").addClass("alert-warning")):($(d+" .lead strong").html("Guardado:"),$(d+" .undo").show(),$(d).removeClass("alert-warning").addClass("alert-info"))),$(d+" .event-type").html(c.description),$(d).data("event-id",a.id),$(d).stop().css("top","-500px").show().animate({top:"0px"}).delay(8e3).animate({top:"-500px"})}function formatDecimal(a){var b=Math.floor(a),c=a-b;return.25==c?b+"&frac14;":.5==c?b+"&frac12;":.75==c?b+"&frac13;":a}function trackEvent(a,b,c,d,e){if(b=b||"",c=c||"",d=d||"",e=e||!1,a){var f=$("<i>").addClass("fa fa-spinner").addClass("fa fa-spin").addClass("fa fa-2x");a.find(".modal-body").append(f)}$.post("track/new",{type:b,subtype:c,value:d},function(c){f&&f.remove(),c.success&&1==c.success?(showNotification(c.event),a&&a.modal("hide"),updateLastEvent(),e&&window.location.reload()):showNotification(b,!0)})}function deleteEvent(a){$.post("track/delete",{id:a},function(a){a.success&&1==a.success?(showNotification(a.event),updateLastEvent()):showNotification(type,!0)})}function updateEvent(a,b){$.post("track/update",{id:a,minutes:b},function(a){a.success&&1==a.success?(showNotification(a.event),updateLastEvent()):showNotification(type,!0)})}$(function(){var a;$("#actividadModal").on("hidden.bs.modal",function(){$("#actividadModal .activity-types button.temporary").remove(),$("#actividadModal .activity-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$("#actividadModal .activity-options").addClass("hide")}),$("#actividadModal .activity-types button").fastClick(function(){if($("#actividadModal .activity-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),"Other"==$(this).data("value")){var b=prompt("Introduce el nombre de la actividad:");if(!b)return!1;var c=$("<button>").attr("type","button").addClass("btn").addClass("btn-lg").addClass("btn-primary").addClass("temporary").data("value",b).html('<i class="fa fa-star"></i> '+b);c.insertBefore($(this)),a=b}else $(this).removeClass("btn-info").addClass("btn-primary"),a=$(this).data("value");return $("#actividadModal .activity-options").removeClass("hide"),!1}),$("#actividadModal button.save").fastClick(function(){return trackEvent($("#actividadModal"),"Actividad",a,$(this).parent().find(".spinner").data("value")),!1})}),$(function(){$(".eventbutton-banyo").fastClick(function(){return trackEvent(null,"Banyo"),!1})}),$(function(){$("#diaperModal button").fastClick(function(){return trackEvent($("#diaperModal"),"Panyal",$(this).data("value")),!1})}),$(function(){var a;$("#milkModal").on("hidden.bs.modal",function(){$("#milkModal .feed-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$("#milkModal .bottle-options").addClass("hide"),$("#milkModal .time-options").addClass("hide")}),$("#milkModal .feed-types button").fastClick(function(){return console.log(),$("#milkModal .feed-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$(this).removeClass("btn-info").addClass("btn-primary"),"left"==$(this).data("value")||"right"==$(this).data("value")?($("#milkModal .time-options").removeClass("hide"),$("#milkModal .bottle-options").addClass("hide")):($("#milkModal .bottle-options").removeClass("hide"),$("#milkModal .time-options").addClass("hide")),a=$(this).data("value"),!1}),$("#milkModal button.save").fastClick(function(){return trackEvent($("#milkModal"),"Leche",a,$(this).parent().find(".spinner").data("value")),!1})}),$("#list-button").fastClick(function(){return $(".card").hasClass("flipped")?($(".card").removeClass("flipped"),$(".face.back table").html(""),$(this).find("i").removeClass("icon-arrow-left").addClass("icon-list")):($(".card").addClass("flipped"),$(this).find("i").removeClass("icon-list").addClass("icon-arrow-left"),$(".face.back table").html(""),$.get("/track/list",function(a){$.each(a,function(a,b){var c=$("<tr>"),d=formatEvent(b);c.append($("<td>").html($("<i>").addClass(b.type.icon)).append(" "+b.type.name)),c.append($("<td>").html(b.time)),c.append($("<td>").html(d.description)),c.append($("<td>").html(d.value)),$(".face.back table").append(c)})})),!1}),$(function(){$("#foodModal .food-types button").fastClick(function(){var a,b=!1;if("Otros"==$(this).data("value")){if(a=prompt("Inserta el nombre de la comida:"),b=!0,!a)return!1}else a=$(this).data("value");return trackEvent($("#foodModal"),"Comida",a,"",b),!1})}),$(function(){$("#dashboard").length&&(updateLastEvent(),setInterval("updateLastEvent()",1e4))}),$(function(){$("#medicineModal .medicine-types button").fastClick(function(){var a,b=!1;if("Otra"==$(this).data("value")){if(a=prompt("Introduce el nombre:"),b=!0,!a)return!1}else a=$(this).data("value");return trackEvent($("#medicineModal"),"Medicina",a,"",b),!1})}),$(function(){$("#milestoneModal button.save").fastClick(function(){var a=$("#milestoneModal textarea").val();return a.length<=0?(alert("Por favor, introduce una descripción:"),!1):a.length>255?(alert("Máximo 255 caracteres, sorry!"),!1):(trackEvent($("#milestoneModal"),"Hito",a),!1)})}),$(function(){$("#noteModal button.save").fastClick(function(){var a=$("#noteModal textarea").val();return a.length<=0?(alert("Por favor escribe una nota:"),!1):a.length>255?(alert("Max 255 caracteres, lo siento!"),!1):(trackEvent($("#noteModal"),"Nota",a),!1)})}),$("#success-notification .undo").fastClick(function(){return deleteEvent($("#success-notification").data("event-id")),!1}),$("#detailsModal button.save").fastClick(function(){return updateEvent($("#success-notification").data("event-id"),$(this).parent().find(".spinner").data("value")),$("#detailsModal").modal("hide"),!1}),$(function(){var a;$("#sacalecheModal").on("hidden.bs.modal",function(){$("#sacalecheModal .pump-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$("#sacalecheModal .pump-options").addClass("hide")}),$("#sacalecheModal .pump-types button").fastClick(function(){return $("#sacalecheModal .pump-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$(this).removeClass("btn-info").addClass("btn-primary"),$("#sacalecheModal .pump-options").removeClass("hide"),a=$(this).data("value"),!1}),$("#sacalecheModal button.save").fastClick(function(){return trackEvent($("#sacalecheModal"),"Sacaleche",a,$(this).parent().find(".spinner").data("value")),!1})}),$(function(){$(".eventbutton-dormir").fastClick(function(){return trackEvent(null,"Dormir"),!1})}),$(function(){$(".spinner .spinner-left").fastClick(function(){var a=$(this).parent().data("value"),b=$(this).parent().data("step"),c=a-=b;c>0&&($(this).parent().data("value",c),$(this).parent().find(".amount").html(formatDecimal(c)))}),$(".spinner .spinner-right").fastClick(function(){var a=$(this).parent().data("value"),b=$(this).parent().data("step"),c=a+=b;$(this).parent().data("value",c),$(this).parent().find(".amount").html(formatDecimal(c))})}),$(function(){var a;$("#suppliesModal").on("hidden.bs.modal",function(){$("#suppliesModal .supplies-types button.temporary").remove(),$("#suppliesModal .supplies-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$("#suppliesModal .supplies-options").addClass("hide")}),$("#suppliesModal .supplies-types button").fastClick(function(){if($("#suppliesModal .supplies-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),"otros"==$(this).data("value")){var b=prompt("Introduce el nombre:");if(!b)return!1;var c=$("<button>").attr("type","button").addClass("btn").addClass("btn-lg").addClass("btn-primary").addClass("temporary").data("value",b).html('<i class="icon-star"></i> '+b);c.insertBefore($(this)),a=b}else $(this).removeClass("btn-info").addClass("btn-primary"),a=$(this).data("value");return $("#suppliesModal .supplies-options").removeClass("hide"),!1}),$("#suppliesModal button.save").fastClick(function(){return trackEvent($("#suppliesModal"),"Suministros",a,$(this).parent().find(".spinner").data("value")),!1})});