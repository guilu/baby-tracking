function formatEvent(a){var b={},c=a.type.name||a.type;switch(b.description="",b.value="",c){case"Milk":b.description=c+" ("+a.subtype+")",b.value="left"==a.subtype||"right"==a.subtype?a.value+" min.":a.value+" ml";break;case"Pump":b.description="Pumped "+a.subtype,b.value=a.value+" ml";break;case"Diaper":b.description="Cambio de pañal "+("both"==a.subtype?"humedo y sucio":a.subtype);break;case"Sleep":b.description="start"==a.subtype?"Inicio dormir":"Fin dormir",a.value&&(a.value>60?b.value=Math.floor(a.value/60)+" horas":b.value=a.value+" min.");break;case"Activity":b.description=a.subtype+" activity",b.value=a.value+" min.";break;case"Medicine":case"Milestone":case"Note":b.description=a.subtype;break;case"Food":b.description="Comió "+a.subtype;break;case"Bath":b.description="Un baño refrescante!";break;case"Supplies":b.description=a.subtype,b.value=a.value+" items."}return b.description=b.description.charAt(0).toUpperCase()+b.description.substr(1),b}function updateLastEvent(){$.get("track/stats",function(a){$(".eventbutton-milk").find(".badge").html(a.milk.time),$(".eventbutton-pump").find(".badge").html(a.pump.time),$(".eventbutton-diaper").find(".badge").html(a.diaper.time),$(".eventbutton-food").find(".badge").html(a.food.time),"start"==a.sleep.type?$(".sleep-items").hasClass("hide")&&($(".sleep-items").removeClass("hide"),$("body, .face.front").animate({backgroundColor:"#D8D8D8"})):$(".sleep-items").hasClass("hide")||($(".sleep-items").addClass("hide"),$("body, .face.front").animate({backgroundColor:"#FFF"}))})}function showNotification(a,b){b=b||!1;var c=formatEvent(a),d=b?"#error-notification":"#success-notification";b||(a.reverted?($(d+" .lead strong").html("Reverted:"),$(d+" .undo").hide(),$(d).removeClass("alert-info").addClass("alert-warning")):($(d+" .lead strong").html("Saved:"),$(d+" .undo").show(),$(d).removeClass("alert-warning").addClass("alert-info"))),$(d+" .event-type").html(c.description),$(d).data("event-id",a.id),$(d).stop().css("top","-500px").show().animate({top:"0px"}).delay(8e3).animate({top:"-500px"})}function formatDecimal(a){var b=Math.floor(a),c=a-b;return.25==c?b+"&frac14;":.5==c?b+"&frac12;":.75==c?b+"&frac13;":a}function trackEvent(a,b,c,d,e){if(b=b||"",c=c||"",d=d||"",e=e||!1,a){var f=$("<i>").addClass("fa fa-spinner").addClass("fa fa-spin").addClass("fa fa-2x");a.find(".modal-body").append(f)}$.post("track/new",{type:b,subtype:c,value:d},function(c){f&&f.remove(),c.success&&1==c.success?(showNotification(c.event),a&&a.modal("hide"),updateLastEvent(),e&&window.location.reload()):showNotification(b,!0)})}function deleteEvent(a){$.post("track/delete",{id:a},function(a){a.success&&1==a.success?(showNotification(a.event),updateLastEvent()):showNotification(type,!0)})}function updateEvent(a,b){$.post("track/update",{id:a,minutes:b},function(a){a.success&&1==a.success?(showNotification(a.event),updateLastEvent()):showNotification(type,!0)})}$(function(){var a;$("#activityModal").on("hidden.bs.modal",function(){$("#activityModal .activity-types button.temporary").remove(),$("#activityModal .activity-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$("#activityModal .activity-options").addClass("hide")}),$("#activityModal .activity-types button").fastClick(function(){if($("#activityModal .activity-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),"Other"==$(this).data("value")){var b=prompt("Introduce el nombre de la actividad:");if(!b)return!1;var c=$("<button>").attr("type","button").addClass("btn").addClass("btn-lg").addClass("btn-primary").addClass("temporary").data("value",b).html('<i class="fa fa-star"></i> '+b);c.insertBefore($(this)),a=b}else $(this).removeClass("btn-info").addClass("btn-primary"),a=$(this).data("value");return $("#activityModal .activity-options").removeClass("hide"),!1}),$("#activityModal button.save").fastClick(function(){return trackEvent($("#activityModal"),"Activity",a,$(this).parent().find(".spinner").data("value")),!1})}),$(function(){$(".eventbutton-bath").fastClick(function(){return trackEvent(null,"Bath"),!1})}),$(function(){$("#diaperModal button").fastClick(function(){return trackEvent($("#diaperModal"),"Diaper",$(this).data("value")),!1})}),$(function(){var a;$("#milkModal").on("hidden.bs.modal",function(){$("#milkModal .feed-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$("#milkModal .bottle-options").addClass("hide"),$("#milkModal .time-options").addClass("hide")}),$("#milkModal .feed-types button").fastClick(function(){return $("#milkModal .feed-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$(this).removeClass("btn-info").addClass("btn-primary"),"left"==$(this).data("value")||"right"==$(this).data("value")?($("#milkModal .time-options").removeClass("hide"),$("#milkModal .bottle-options").addClass("hide")):($("#milkModal .bottle-options").removeClass("hide"),$("#milkModal .time-options").addClass("hide")),a=$(this).data("value"),!1}),$("#milkModal button.save").fastClick(function(){return trackEvent($("#milkModal"),"Milk",a,$(this).parent().find(".spinner").data("value")),!1})}),$("#list-button").fastClick(function(){return $(".card").hasClass("flipped")?($(".card").removeClass("flipped"),$(".face.back table").html(""),$(this).find("i").removeClass("icon-arrow-left").addClass("icon-list")):($(".card").addClass("flipped"),$(this).find("i").removeClass("icon-list").addClass("icon-arrow-left"),$(".face.back table").html(""),$.get("/track/list",function(a){$.each(a,function(a,b){var c=$("<tr>"),d=formatEvent(b);c.append($("<td>").html($("<i>").addClass(b.type.icon)).append(" "+b.type.name)),c.append($("<td>").html(b.time)),c.append($("<td>").html(d.description)),c.append($("<td>").html(d.value)),$(".face.back table").append(c)})})),!1}),$(function(){$("#foodModal .food-types button").fastClick(function(){var a,b=!1;if("Other"==$(this).data("value")){if(a=prompt("Enter food name:"),b=!0,!a)return!1}else a=$(this).data("value");return trackEvent($("#foodModal"),"Food",a,"",b),!1})}),$(function(){$("#dashboard").length&&(updateLastEvent(),setInterval("updateLastEvent()",1e4))}),$(function(){$("#medicineModal .medicine-types button").fastClick(function(){var a,b=!1;if("Other"==$(this).data("value")){if(a=prompt("Enter name:"),b=!0,!a)return!1}else a=$(this).data("value");return trackEvent($("#medicineModal"),"Medicine",a,"",b),!1})}),$(function(){$("#milestoneModal button.save").fastClick(function(){var a=$("#milestoneModal textarea").val();return a.length<=0?(alert("Por favor, introduce una descripción:"),!1):a.length>255?(alert("Máximo 255 caracteres, sorry!"),!1):(trackEvent($("#milestoneModal"),"Milestone",a),!1)})}),$(function(){$("#noteModal button.save").fastClick(function(){var a=$("#noteModal textarea").val();return a.length<=0?(alert("Por favor escribe una nota:"),!1):a.length>255?(alert("Max 255 caracteres, lo siento!"),!1):(trackEvent($("#noteModal"),"Note",a),!1)})}),$("#success-notification .undo").fastClick(function(){return deleteEvent($("#success-notification").data("event-id")),!1}),$("#detailsModal button.save").fastClick(function(){return updateEvent($("#success-notification").data("event-id"),$(this).parent().find(".spinner").data("value")),$("#detailsModal").modal("hide"),!1}),$(function(){var a;$("#pumpModal").on("hidden.bs.modal",function(){$("#pumpModal .pump-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$("#pumpModal .pump-options").addClass("hide")}),$("#pumpModal .pump-types button").fastClick(function(){return $("#pumpModal .pump-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$(this).removeClass("btn-info").addClass("btn-primary"),$("#pumpModal .pump-options").removeClass("hide"),a=$(this).data("value"),!1}),$("#pumpModal button.save").fastClick(function(){return trackEvent($("#pumpModal"),"Pump",a,$(this).parent().find(".spinner").data("value")),!1})}),$(function(){$(".eventbutton-sleep").fastClick(function(){return trackEvent(null,"Sleep"),!1})}),$(function(){$(".spinner .spinner-left").fastClick(function(){var a=$(this).parent().data("value"),b=$(this).parent().data("step"),c=a-=b;c>0&&($(this).parent().data("value",c),$(this).parent().find(".amount").html(formatDecimal(c)))}),$(".spinner .spinner-right").fastClick(function(){var a=$(this).parent().data("value"),b=$(this).parent().data("step"),c=a+=b;$(this).parent().data("value",c),$(this).parent().find(".amount").html(formatDecimal(c))})}),$(function(){var a;$("#suppliesModal").on("hidden.bs.modal",function(){$("#suppliesModal .supplies-types button.temporary").remove(),$("#suppliesModal .supplies-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),$("#suppliesModal .supplies-options").addClass("hide")}),$("#suppliesModal .supplies-types button").fastClick(function(){if($("#suppliesModal .supplies-types button").removeClass("btn-primary").removeClass("btn-info").addClass("btn-info"),"other"==$(this).data("value")){var b=prompt("Enter name:");if(!b)return!1;var c=$("<button>").attr("type","button").addClass("btn").addClass("btn-lg").addClass("btn-primary").addClass("temporary").data("value",b).html('<i class="icon-star"></i> '+b);c.insertBefore($(this)),a=b}else $(this).removeClass("btn-info").addClass("btn-primary"),a=$(this).data("value");return $("#suppliesModal .supplies-options").removeClass("hide"),!1}),$("#suppliesModal button.save").fastClick(function(){return trackEvent($("#suppliesModal"),"Supplies",a,$(this).parent().find(".spinner").data("value")),!1})});